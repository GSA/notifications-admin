{% extends "withnav_template.html" %}

{% from "components/show-more.html" import show_more %}
{% from "components/table.html" import list_table, field, right_aligned_field_heading, hidden_field_heading %}
{% from "components/ajax-block.html" import ajax_block %}

{% block service_page_title %}
  Dashboard
{% endblock %}

{% block maincolumn_content %}

  <div class="dashboard margin-bottom-8">

    <h1 class="usa-sr-only">Dashboard</h1>
    {% if current_user.has_permissions('manage_templates') and not current_service.all_templates %}
      {% include 'views/dashboard/write-first-messages.html' %}
    {% endif %}

    {{ ajax_block(partials, updates_url, 'upcoming') }}

    <h2 class="font-body-lg margin-top-0 margin-bottom-1">
      In the last seven days
    </h2>

    {{ ajax_block(partials, updates_url, 'inbox') }}

    {{ ajax_block(partials, updates_url, 'totals') }}

    {{ ajax_block(partials, updates_url, 'template-statistics') }}

    <h2 class="heading-small margin-bottom-1">Daily messages across all services</h2>
    <p class="margin-top-0"><strong>{{ daily_global_messages_remaining }}</strong> free text messages left</p>

    {% if current_user.has_permissions('manage_service') %}
      <h2 class='font-body-lg margin-bottom-1'>This year</h2>
      {{ ajax_block(partials, updates_url, 'usage') }}
      {{ show_more(
        url_for(".usage", service_id=current_service['id']),
        'See usage'
      ) }}
    {% endif %}
  </div>

{% endblock %}
